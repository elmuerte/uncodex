<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html>
<head>
	<title>UnCodeX - Pascal Script - TUCXIniFile</title>
	<link href="../images/default.css" rel="stylesheet" type="text/css">
</head>
<body>
<div class="main">
<div class="head">
<img src="../images/UnCodeX-icon.gif" alt="UnCodeX" align="top">
<div class="title"><span class="title_high">UnCodeX</span><span class="title_low">UnCodeX</span><span class="title">UnCodeX</span></div>
<div class="subject">TUCXIniFile</div>
</div>

<div class="content">
<h1>TUCXIniFile</h1>
<pre>
  TUCXIniFile = class(TObject)
  public
    constructor Create(const AFileName: string);
    destructor Destroy; override;

    procedure ReadSections(Strings: TStrings);
    function SectionExists(const Section: string): Boolean;
    procedure ReadSection(const Section: string; Strings: TStrings);
    procedure EraseSection(const Section: string);
    procedure ReadSectionValues(const Section: string; Strings: TStrings);
    procedure ReadSectionRaw(const Section: string; Strings: TStrings);
    procedure WriteSectionRaw(const Section: string; Strings: TStrings);

    procedure DeleteKey(const Section, Ident: String);
    function ValueExists(const Section, Ident: string): Boolean;

    function ReadString(const Section, Ident, Default: string): string;
    procedure WriteString(const Section, Ident, Value: String);
    function ReadInteger(const Section, Ident: string; Default: Longint): Longint;
    procedure WriteInteger(const Section, Ident: string; Value: Longint);
    function ReadBool(const Section, Ident: string; Default: Boolean): Boolean;
    procedure WriteBool(const Section, Ident: string; Value: Boolean);
    function ReadFloat(const Section, Ident: string; Default: Double): Double;
    procedure WriteFloat(const Section, Ident: string; Value: Double);

    function ReadDate(const Section, Ident: string; Default: TDateTime): TDateTime;
    function ReadDateTime(const Section, Ident: string; Default: TDateTime): TDateTime;
    function ReadTime(const Section, Ident: string; Default: TDateTime): TDateTime;
    procedure WriteDate(const Section, Ident: string; Value: TDateTime);
    procedure WriteDateTime(const Section, Ident: string; Value: TDateTime);
    procedure WriteTime(const Section, Ident: string; Value: TDateTime);

    procedure ReadStringArray(const section, ident: string; output: TStrings; append: boolean = false);
    procedure WriteStringArray(const section, ident: string; input: TStrings);
    procedure AddToStringArray(const section, ident: string; entry: string);
    function RemoveFromStringArray(const section, ident: string; entry: string): boolean;

    procedure WriteBinaryStream(const Section, Name: string; Value: TStream);
    function ReadBinaryStream(const Section, Name: string; Value: TStream): Integer;

    procedure UpdateFile;
    procedure Rename(const AFileName: string; Reload: Boolean);
    procedure Clear;
    procedure GetStrings(List: TStrings);
    procedure SetStrings(List: TStrings);

    property FileName: string read FFileName;
    property EscapeLineFeeds: boolean read FEscapeLineFeeds write FEscapeLineFeeds;
    property DelayedUpdate: boolean read FDelayedUpdate write FDelayedUpdate;
  end;
</pre>

</div>
</div>
</body>
</html>